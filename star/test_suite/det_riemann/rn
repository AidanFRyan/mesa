#!/bin/bash

# this provides the definition of do_one (run one part of test)
# do_one [inlist] [output model] [LOGS directory]
MESA_DIR=../../..
source "${MESA_DIR}/star/test_suite/test_suite_helpers"

date "+DATE: %Y-%m-%d%nTIME: %H:%M:%S"

# check if can skip building zams model
if [ -z "$MESA_RUN_OPTIONAL" ]; then
   cp standard_zams.mod zams.mod
else
   do_one inlist_zams_header zams.mod
   cp zams.mod standard_zams.mod
fi

# check if can skip building removed_center model
if [ -z "$MESA_RUN_OPTIONAL" ]; then
   cp standard_removed_center.mod removed_center.mod
else
   do_one inlist_remove_center_header removed_center.mod
   cp removed_center.mod standard_removed_center.mod
fi

# check if can skip building ready_to_shock model
if [ -z "$MESA_RUN_OPTIONAL" ]; then
   cp standard_ready_to_shock.mod ready_to_shock.mod
else
   do_one inlist_prepare_header ready_to_shock.mod
   cp ready_to_shock.mod standard_ready_to_shock.mod
fi

# check if can skip building done_with_edep model
if [ -z "$MESA_RUN_OPTIONAL" ]; then
   cp standard_done_with_edep.mod done_with_edep.mod
#else
   do_one inlist_start_shock_header done_with_edep.mod
   cp done_with_edep.mod standard_done_with_edep.mod
#fi

do_one inlist_shock_header final.mod

date "+DATE: %Y-%m-%d%nTIME: %H:%M:%S"

echo 'finished'

